<head>
  <meta charset="UTF-8">
  <title>{{ site.title }}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <link rel="stylesheet" href="{{ site.baseurl }}/css/normalize.css">
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="{{ site.baseurl }}/css/cayman.css">
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]}
    });
  </script>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML-full"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function(){
      var d = document.getElementById('Список-литературы');
      if(!d) return;
      d = d.nextElementSibling.children;
      var r = [];
      for (var x = 0; x < d.length; x++) {
        d[x].id = 'r' + (x + 1);
        r[x] = d[x].textContent;
      }
      
      var ps = document.getElementsByTagName('p');
      for (var x = 0; x < d.length; x++) {
        var s = ps[x].innerHTML, s1 = s.replace(/ \((\d+)\)/g, ' <a href="#e$1">($1)</a>');
        var a = s1.split('['), l = a.length;
        if (l <= 1) {
          if (s !== s1) ps[x].innerHTML = s1;
          continue;
        }
        for (var y = 1; y < l; y++) {
          var m = a[y].match(/^([\d, -]+)\]/);
          if(!m) continue;
          var refs = m[1].split(',').map(function(i){
            return i.split('-').map(function(i){
              v = parseInt(i.trim());
              if (!v || v > r.length) return i;
              return '<a href="#r' + v + '" title="' + r[v - 1] + '">' + i.trim() + '</a>';            
            }).join('&ndash;');
          }).join(', ');
          a[y] = a[y].replace(/^[\d, -]+\]/, refs + ']');
        }
        //var rp = s.replace(/\[(\d+)\]/g, '<a href="#r$1">[$1]</a>');
        ps[x].innerHTML = a.join('[');// rp;
      }
      
      var content = document.getElementsByClassName('main-content')[0].children;
      for(var x = 0; x < content.length; x++) {
        var tag = content[x].tagName;
        if (tag === 'H2' || tag === 'H1' || tag === 'H3')
          console.log(tag + ': ' + content[x].innerText);
      }
    });
  </script>
</head>
